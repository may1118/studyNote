# 虚拟DOM

[TOC]

## DOM的缺陷

- JavaScript操作DOM会影响整个渲染流水线
- DOM提供了一组JavaScript接口用来遍历或修改节点

*例如：*

调用`document.body.appendChild(node)`API会引发一系列的连锁反应。

- 将node节点添加到body节点上
- 触发样式计算、布局、绘制、栅格化、合成等任务（“**重排**”）

除了重排之外，还可能因为调用某些API触发“**重绘**”或者“**合成**”操作，形象的理解就是“**牵一发而动全身**”。

另外，对于DOM的不当操作还肯呢个引发“**强制同步布局**”和“**布局抖动**”的问题，这些操作都会大大降低渲染效率。因此，对于DOM操作我们时刻都要非常小心谨慎。

## 虚拟DOM

虚拟DOM解决了那些事情：

- 将页面改变的内容应用到虚拟DOM上，而不是直接应用到DOM上
- 变化被应用到虚拟DOM上时，虚拟DOM并不急着去渲染页面，而仅仅是改变虚拟DOM的内部状态，这样操作虚拟DOM的代价就变得非常轻了
- 在虚拟DOM收集到足够的改变时，再把这些变化一次性应用到真实DOM上

