# 利用网络面板做性能分析

[TOC]

- DOMContentLoaded事件：页面已经构建好了DOM，也就意味着DOM所需要的HTML文件、JavaScript文件、CSS文件都已经下载完成了
- Load事件：浏览器已经加载了所有资源（图像、样式表等）

![](I:\myFuture\桌面资料\面试\学习图片\单个文件的时间线.png)

## 具体过程

### Queuing

排队等待的时间，一个请求可能因为众多原因不会立即被处理

- 页面中的资源是有优先级的
  - HTML、CSS、JavaScript优先级高
  - 图像、视频、音频优先级低
- 每个域名最多可以维护6个TCP连接
- 数据分配磁盘空间的时候，新的HTTP请求也需要短暂的等待磁盘分配结束

### Stalled

“**停滞**”的意思，发起连接之前还有其他原因导致连接过程被推迟

### proxy negotiation

“**代理协商**”阶段，代理服务器连接协商所用时间（如果使用了代理服务器就会显示出来）

### initial connection/SSL

和服务器建立连接，包括：TCP连接所花费的时间，如果使用了HTTPS连接，还需要加上SSL握手时间

### request send

只需要将浏览器缓冲区的数据发送出去即可，并不需要判断服务器是否接收到

### waiting（TTFB）

“**第一字节**”，反映服务器响应的重要指标，越短说明响应时间越快

### content Download

从第一字节到接收到全部响应数据所用的时间

## 优化

### 排队（Queuing）时间过久

因为每个域名下最多维护6个TCP连接

- 域名分片
- 升级到HTTP/2

### 第一字节（TTFB）时间过久

- 服务器生成页面数据的时间过久：对于动态页面来说，服务器收到一个请求时，首先需要从数据库中读取页面需要的数据，然后传入模板，模板渲染后，再返回给用户。
- 网络原因：可能使用了低带宽的服务器，或者用的是电信的服务器，用户是联通的
- 发送请求头时带上了多余的用户信息：cookie

### Content Download时间过久

可能是字节数太多导致。可以压缩文件大小