# 浏览器

[TOC]

## 进程VS线程

- 进程中的任意一线程执行出错，都会导致整个进行的崩溃。
- 线程之间共享进程中的数据
- 当一个进程关闭之后，操作系统会挥手进程所占用的内存
- 进程之间的内容是相互隔离

## 单进程浏览器

**浏览器里所有功能模块都运行在同一个进程里。**这些模块包括：网络、插件、JavaScript运行环境、渲染引擎和页面等。

### 缺点：

- 不稳定：一个模块出现崩溃，会导致整个浏览器的崩溃
- 不流畅：同一时刻只能由一个模块可以执行
- 不安全：插件使用C/C++等代码编写，可以通过插件获取到操作系统的任意资源；页面脚本：可以通过浏览器的漏洞来获取系统权限

## 多进程浏览器

例如：谷歌

解决单进程浏览器的不足：

- 不稳定：由于进程是相互隔离的，所以当一个页面崩溃时，影响到的仅仅是当前的页面进行或者插件进程
- 不流畅：如果JavaScript阻塞了渲染，影响到的也只是当前的渲染页面，并不会影响浏览器和其他页面；内存泄漏当被关闭的时候，占用的内存都会被系统回收
- 安全：使用到了“**安全沙箱**”，操作系统给进程上了一把锁，沙箱里面的程序可以运行，但是不能在硬盘上写入任何的数据，也不能在敏感位置读取任何数据

![](I:\myFuture\桌面资料\面试\学习图片\Chrome进程架构图.png)

可以看出，最新Chrome浏览器包括：1个浏览器主进程、1个GPU进程、1个网络进程、多个渲染进程和多个插件进程

- 浏览器进程：界面显示、用户交互、子进程管理，同时提供存储等功能
- 渲染进程：将HTML、CSS和JavaScript转换为用户可以与之交互的页面，排版引擎Blink和JavaScript引擎V8都时运行在该进程中，默认情况下，Chrome会为每个Tab标签创建一个渲染进程。处于安全考虑，渲染进程都是运行在沙箱模式下
- GPU进程：实现3D CSS的效果，只是随后网页、Chrome的UI界面都是采用GPU进程绘制的
- 网络进程：负责网络资源加载
- 插件进程：负责插件的运行，因为插件容易崩溃，所以需要通过插件进程来隔离，以保证插件进程崩溃不会对浏览器和页面造成影响

### 缺点

- 更高的资源消耗：因为每个都会包含公共基础架构的副本，意味着浏览器会消耗更多的内存资源
- 更复杂的体系架构：各个模块之间耦合行高、扩展性差等问题，会导致现在的架构已经很难适应新的需求了

