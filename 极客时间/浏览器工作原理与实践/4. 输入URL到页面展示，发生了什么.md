# 输入URL到页面展示，发生了什么

[TOC]

## 用户输入

地址栏判断输入的关键字是输入内容还是请求URL

- 输入内容，请求栏使用浏览器默认的搜索引擎，来合成新的带关键字搜索的URL
- 请求URL，浏览器会合并成一个完成的URL

## URL请求过程

浏览器进程会通过“**进程间通信**”（“**IPC**”）把URL请求发送至网络进程，网络进程接收到URL请求后，会在这里发起真正的URL请求流程

- 查看本地缓存是否缓存了该资源

  - 有缓存，直接返回
- DNS解析，获取请求的域名的服务器IP地址
- 利用IP地址和服务器建立TCP连接
- 如果是HTTPS，还需要建立TLS连接
- 浏览器构建请求行、请求头等信息，并把和该域名相关的Cookie等数据附加到请求头中，然后向服务器发送构建的请求信息
- 服务器接收到请求信息后，会根据请求信息生成响应数据，并发给网络进程。等网络进程接受了响应行和响应头之后，就开始解析响应头内容了。

  - 如果返回状态码301/302....需要进行重定向，会根据“**Location**”字段读取重定向的地址，然后再发起请求
  - 如果是200，那么标识浏览器可以继续处理该请求
- 响应类型处理

  - 根据“Content-Type”，告诉浏览器服务器返回的响应数据是什么类型
- （Content-Type：text/html）
## 准备渲染进程

  - 如果新页面和当前页面不属于同一个站点，那么会开一个渲染进程，如果不是则复用父页面的渲染进程

## 提交文档：URL请求的响应体数据

  - 渲染进程接收到“**提交文档**”的信息后，回个网络进程建立传输数据的“**通道**”
  - 数据传输完成，渲染进程会返回“**确认提交**”的消息给浏览器进程
  - “**确认提交**”消息后，会**更新浏览器界面信息**，包括了安全状态、地址栏的URL、前进后退的历史状态，并更新Web页面
  - （从输入到显示流程完毕）

## 渲染阶段