# JS异步解决方案的发展历程以及优缺点

- 回调函数
- 事件监听
- 发布/订阅
- Promise对象

## 回调函数

```js
function f1(callback){
    setTimeout(function (){
        callback();
    },1000);
}
// 执行
f1(f2);
```

**优点：**

简单、容易理解和部署

**缺点：**

不利于代码的阅读和维护，各个部分之间高度耦合，流程会很乱，而且每个任务只能指定一个回调函数。

## 事件监听

事件驱动模式。任务的执行不取决于代码的顺序，而是取决于某个事件是否发生。

使用**jQuery**的写法

```js
f1.on('done',f2);

function f1(){
    setTimeout(()=>{
        f1.trigger('done');
    },1000);
}
```

`f1.trigger('done')`表示，执行完成后，立即触发done事件，从而开始执行f2

**优点：**

比较容易理解，可以绑定多个事件，每个事件可以指定多个回调函数，而且可以**去耦合**，有利于实现模块化

**缺点：**

整个程序都要编程事件驱动型，运行流程会变得很不清晰。

## 发布/订阅

我们假定存在一个“**信号中心**”，某个任务执行完成，就向信号中心**发送**一个信息，其他任务可以向信号中心**订阅**这个信号，从而知道什么时候可以开始执行。这就叫做“**发布/订阅模式**”，又称“**观察者模式**”

## Promise对象

目的是为异步编程提供统一的接口。

**思想**：每一个异步任务返回一个`Promise`对象，该对象有一个`then`方法，允许指定回调函数。